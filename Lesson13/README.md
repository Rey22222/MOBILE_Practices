# Практическая работа №13

**Тема:** Разработка мобильного приложения с использованием библиотек Retrofit и Picasso для работы с сетью.

---

## 1. Создание сетевого слоя (RetrofitApp)

В рамках учебного модуля была реализована логика взаимодействия с REST API для управления списком задач.

### Модель данных и интерфейс
*   **Модель данных:** создан POJO-класс `Todo.java`, структура которого полностью соответствует полям JSON-объекта API (id, todo, completed).
*   **API-интерфейс:** создан интерфейс `ApiService.java`, где с помощью аннотации `@GET("todos")` описан асинхронный запрос на получение списка дел.

### Пользовательский интерфейс и логика
*   В файле `activity_main.xml` добавлен компонент **RecyclerView** для отображения динамического списка.
*   Создан макет `item_todo.xml`, содержащий `TextView` для текста задачи и `CheckBox` для отображения и изменения статуса выполнения.
*   В `MainActivity.java` произведена инициализация **Retrofit** и выполнен запрос через метод `enqueue()`. Полученные данные передаются в адаптер для отрисовки на экране.

---

## 2. Интеграция библиотеки Picasso

Для визуализации списка задач в каждый элемент был добавлен графический контент, загружаемый из внешних источников.

### Модификация адаптера
В класс `TodoAdapter` внедрена работа с изображениями:
*   В классе `TodoViewHolder` объявлена ссылка на целевой объект `ImageView`.
*   В методе `onBindViewHolder` реализован механизм загрузки. URL изображения формируется динамически на основе уникального идентификатора задачи.

```
Picasso.get()
    .load("https://api.dicebear.com/7.x/identicon/png?seed=" + todo.getId())
    .placeholder(android.R.drawable.ic_menu_rotate)
    .error(android.R.drawable.ic_delete)
    .into(holder.imageViewTodo);
```
<img width="1280" height="516" alt="image" src="https://github.com/user-attachments/assets/0beb1591-c431-4da5-9678-8d25e1051fab" />
<img width="1280" height="527" alt="image" src="https://github.com/user-attachments/assets/e71cfe8f-d3be-4580-83ba-51ccada6de08" />

### 3. Контрольное задание: Проект Succuforest

В основном проекте **Succuforest** (магазин суккулентов) реализована полноценная интеграция сетевого взаимодействия в многомодульную архитектуру приложения.

#### Обновление моделей и сетевого слоя
*   **Модели данных:** модели `Succulent` (слой domain) и `SucculentEntity` (слой data) были модифицированы для поддержки работы с полем `imageUrl` (строковая ссылка) вместо использования локальных ресурсов.
*   **Сетевой слой:** реализован интерфейс `SucculentApiService` для взаимодействия с персональным API, развернутым на платформе **MockAPI.io**.

#### Интеграция с репозиторием и кэширование
В классе `SucculentRepositoryImpl` реализована логика совместной работы сетевых запросов и локальной базы данных **Room**:
*   При запросе каталога приложение инициирует сетевой запрос через **Retrofit**.
*   При успешном ответе данные автоматически сохраняются или обновляются в **Room** с использованием стратегии **REPLACE**.
*   В случае отсутствия интернет-соединения репозиторий обеспечивает отказоустойчивость, возвращая данные из локального кэша.
*   Механизм «Избранного» синхронизирует статус состояния растения между объектами, полученными из сети, и записями в локальной БД.

#### Обновление UI-слоя
Адаптеры каталога и избранного, а также экран подробной информации (`DetailsActivity`) переведены на загрузку изображений по URL-адресам.

```
Picasso.get()
    .load(succulent.getImageUrl())
    .placeholder(android.R.drawable.ic_menu_gallery)
    .error(android.R.drawable.stat_notify_error)
    .fit()
    .centerCrop()
    .into(ivDetailImage);
```
<img width="1250" height="1270" alt="image" src="https://github.com/user-attachments/assets/cb17ead6-ab12-44ea-9a70-1043bf881fb6" />
<img width="2311" height="1102" alt="image" src="https://github.com/user-attachments/assets/18e7752f-1596-40e0-a80e-6bfaf6bc5992" />
<img width="2378" height="1098" alt="image" src="https://github.com/user-attachments/assets/6e54591c-f261-4669-9281-6a567ec82fca" />

## Итоги

В ходе выполнения практической работы были успешно освоены технологии сетевого взаимодействия в среде Android:

*   Библиотека **Retrofit** применена для выполнения **GET** и **PUT** запросов, а также для автоматической десериализации **JSON**-ответов в объекты Java.
*   Библиотека **Picasso** интегрирована для асинхронной загрузки фотографий растений, что позволило перенести хранение графики на внешний сервер и оптимизировать итоговый размер приложения.
*   Реализована архитектурная связка **Retrofit + Room + LiveData**, обеспечивающая стабильную работу приложения в условиях нестабильного интернет-соединения.
*   Приложение **Succuforest** теперь обладает динамическим каталогом, данные в котором обновляются удаленно через **MockAPI** без необходимости пересборки проекта.

---
**Выполнила:** Хасанова Рената  
**Группа:** БСБО-07-22
